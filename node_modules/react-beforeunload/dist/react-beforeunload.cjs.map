{"version":3,"file":"react-beforeunload.cjs","sources":["../src/useBeforeunload.js","../src/Beforeunload.js"],"sourcesContent":["import { useEffect, useRef } from 'react';\n\n/**\n * React hook that listens to `beforeunload` window event.\n * @function\n * @param {?function(BeforeUnloadEvent): ?string} handler - Event listener\n *   called on `beforeunload` window event. It activates a confirmation dialog\n *   when `event.preventDefault()` is called or a string is returned.\n */\nexport const useBeforeunload = (handler) => {\n  const enabled = typeof handler === 'function';\n\n  // Persist handler in ref\n  const handlerRef = useRef(handler);\n  useEffect(() => {\n    handlerRef.current = handler;\n  });\n\n  useEffect(() => {\n    if (enabled) {\n      const listener = (event) => {\n        const returnValue = handlerRef.current(event);\n\n        if (typeof returnValue === 'string') {\n          event.preventDefault();\n          // Handle legacy `event.returnValue` and `return` activation.\n          // https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload_event#compatibility_notes\n          return (event.returnValue = returnValue);\n        }\n\n        // Chrome doesn't support `event.preventDefault()` on `BeforeUnloadEvent`.\n        // https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload_event#compatibility_notes\n        if (event.defaultPrevented) {\n          return (event.returnValue = '');\n        }\n      };\n\n      window.addEventListener('beforeunload', listener);\n      return () => {\n        window.removeEventListener('beforeunload', listener);\n      };\n    }\n  }, [enabled]);\n};\n","import { useBeforeunload } from './useBeforeunload';\n\nexport const Beforeunload = ({ children = null, onBeforeunload }) => {\n  useBeforeunload(onBeforeunload);\n  return children;\n};\n"],"names":["useBeforeunload","handler","enabled","handlerRef","useRef","useEffect","listener","event","returnValue","Beforeunload","children","onBeforeunload"],"mappings":"yGASaA,EAAmBC,GAAY,CAC1C,MAAMC,EAAU,OAAOD,GAAY,WAG7BE,EAAaC,SAAOH,CAAO,EACjCI,EAAAA,UAAU,IAAM,CACdF,EAAW,QAAUF,CACzB,CAAG,EAEDI,EAAAA,UAAU,IAAM,CACd,GAAIH,EAAS,CACX,MAAMI,EAAYC,GAAU,CAC1B,MAAMC,EAAcL,EAAW,QAAQI,CAAK,EAE5C,GAAI,OAAOC,GAAgB,SACzB,OAAAD,EAAM,eAAc,EAGZA,EAAM,YAAcC,EAK9B,GAAID,EAAM,iBACR,OAAQA,EAAM,YAAc,EAEtC,EAEM,cAAO,iBAAiB,eAAgBD,CAAQ,EACzC,IAAM,CACX,OAAO,oBAAoB,eAAgBA,CAAQ,CAC3D,EAEA,EAAK,CAACJ,CAAO,CAAC,CACd,ECzCaO,EAAe,CAAC,CAAE,SAAAC,EAAW,KAAM,eAAAC,CAAc,KAC5DX,EAAgBW,CAAc,EACvBD"}